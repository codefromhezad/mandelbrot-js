<style>
    body {
        margin: 0;
        padding: 0;
    }

    canvas {
        display: block;
        float: left;
    }

    dl.fractal-infos {
        display: block;
        float: left;
    }
</style>

<script src="jquery.js"></script>
<script src="plugins.js"></script>
<script src="Mandelbrot.js"></script>

<canvas id="canvas1" width="600" height="600">
    Random Canvas
</canvas>

<dl class="fractal-infos">
    <dt>Scale</dt><dd class="scale">...<dd/>
    <dt>Position</dt><dd class="position">...<dd/>
    <dt>Fractal type</dt><dd class="fractype"><select></select><dd/>
    <dt>Coloring Algorithm</dt><dd class="coloring"><select></select><dd/>
    <dt>Max Iterations</dt><dd class="max-iterations"><input type="text" /><dd/>
    <dt>Palette Offset</dt><dd class="palette-offset"><input type="text" /><dd/>
</dl>

<button class="update">Update</button>

<script type="text/javascript">
    
    var SCALE = 4.0;
    var PX = - 0.5;
    var PY = - 0.0;

    var MAX_ITERATIONS = 200;

    var fractal = new Mandelbrot('canvas1');

    $('.fractal-infos .scale').text(SCALE);
    $('.fractal-infos .position').text(PX+', '+PY);
    $('.fractal-infos .palette-offset input').val(fractal.paletteOffset);
    $('.fractal-infos .max-iterations input').val(MAX_ITERATIONS);

    for(var i in Plugins) {
        $('.fractal-infos .fractype select').append('<option value="'+i+'">'+Plugins[i].desc+'</option>')
    }
    $('.fractal-infos .fractype select option[value=mandelbrot]').attr('selected', 'selected');

    for(var i in COLORING) {
        $('.fractal-infos .coloring select').append('<option value="'+COLORING[i]+'">'+COLORING[i]+'</option>')
    }
    $('.fractal-infos .coloring select').val(fractal.coloringAlgorithm);

    fractal.render(SCALE, PX, PY);

    $('#canvas1').click( function(e) {
        var posX = $(this).offset().left,
            posY = $(this).offset().top;
        
        var m = {
            x: e.pageX - posX,
            y: e.pageY - posY
        };

        var f = fractal.canvasToFractalCoords(m);
        SCALE /= 2;
        PX = f.x;
        PY = f.y;

        $('.fractal-infos .scale').text(SCALE);
        $('.fractal-infos .position').text(PX+', '+PY);

        fractal.render(SCALE, PX, PY);
    });

    $('button.update').click( function(e) {
        e.preventDefault();
        
        var fractTypeSelected = $('.fractal-infos .fractype select').val();
        var params = null;
        if( fractTypeSelected == "julia" ) {
            params = {cx: -0.98, cy: 0.34};
        }
        fractal.setFractalFunction( fractTypeSelected, params );

        fractal.coloringAlgorithm = $('.fractal-infos .coloring select').val();
        fractal.paletteOffset = parseInt($('.fractal-infos .palette-offset input').val());
        MAX_ITERATIONS = parseInt($('.fractal-infos .max-iterations input').val());
        
        fractal.render(SCALE, PX, PY);

        return false;
    })

</script>